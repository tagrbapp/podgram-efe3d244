# ูุธุงู ุงูุฅุดุนุงุฑุงุช ูู ุงูููุช ุงููุนูู

ุชู ุฅุถุงูุฉ ูุธุงู ุฅุดุนุงุฑุงุช ูุชูุงูู ูู ุงูููุช ุงููุนูู ุจุงุณุชุฎุฏุงู Supabase Realtime.

## ุงููุฒุงูุง

- โ ุฅุดุนุงุฑุงุช ููุฑูุฉ ูู ุงูููุช ุงููุนูู
- โ ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ ุนูู ุงูุฃููููุฉ
- โ toast notifications ุนูุฏ ูุตูู ุฅุดุนุงุฑ ุฌุฏูุฏ
- โ ุชุญุฏูุฏ ุฌููุน ุงูุฅุดุนุงุฑุงุช ูููุฑูุกุฉ
- โ ุญุฐู ุงูุฅุดุนุงุฑุงุช ูุฑุฏูุงู ุฃู ุฌูุงุนูุงู
- โ ุชุตููู ุงูุฅุดุนุงุฑุงุช ุญุณุจ ุงูููุน ูุน ุฃููููุงุช ูููุฒุฉ
- โ animations ุณูุณุฉ ููุตููุฉ ุจุดูู ุงุญุชุฑุงูู

## ุงูููููุงุช ุงูุฑุฆูุณูุฉ

### 1. useRealtimeNotifications Hook

Hook ูุฎุตุต ููุชุนุงูู ูุน ุงูุฅุดุนุงุฑุงุช ูู ุงูููุช ุงููุนูู:

```typescript
const {
  notifications,      // ูุงุฆูุฉ ุงูุฅุดุนุงุฑุงุช
  unreadCount,       // ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ
  loading,           // ุญุงูุฉ ุงูุชุญููู
  markAsRead,        // ุชุญุฏูุฏ ุฅุดุนุงุฑ ูููุฑูุก
  markAllAsRead,     // ุชุญุฏูุฏ ุงููู ูููุฑูุก
  deleteNotification, // ุญุฐู ุฅุดุนุงุฑ
  deleteAllNotifications // ุญุฐู ุฌููุน ุงูุฅุดุนุงุฑุงุช
} = useRealtimeNotifications(userId);
```

### 2. NotificationsDropdown Component

ูููู dropdown ูุนุฑุถ ุงูุฅุดุนุงุฑุงุช:

```tsx
<NotificationsDropdown userId={user?.id || null} />
```

### 3. ููุชุจุฉ ุฅูุดุงุก ุงูุฅุดุนุงุฑุงุช

```typescript
import { createNotification } from "@/lib/notifications";

// ุฅูุดุงุก ุฅุดุนุงุฑ ูุงุญุฏ
await createNotification({
  userId: "user-id",
  title: "ุนููุงู ุงูุฅุดุนุงุฑ",
  message: "ูุญุชูู ุงูุฅุดุนุงุฑ",
  type: "message", // message | bid | sale | review | favorite | auction_start | etc
  listingId: "listing-id", // ุงุฎุชูุงุฑู
  relatedUserId: "related-user-id" // ุงุฎุชูุงุฑู
});

// ุฅูุดุงุก ุฅุดุนุงุฑุงุช ูุชุนุฏุฏุฉ
await createBulkNotifications([
  { userId: "user1", title: "...", message: "...", type: "bid" },
  { userId: "user2", title: "...", message: "...", type: "sale" }
]);
```

## ุฃููุงุน ุงูุฅุดุนุงุฑุงุช ุงููุฏุนููุฉ

| ุงูููุน | ุงูุฃููููุฉ | ุงููุตู |
|------|---------|-------|
| `message` | ๐ฌ | ุฑุณุงูุฉ ุฌุฏูุฏุฉ |
| `bid` | ๐จ | ูุฒุงูุฏุฉ ุฌุฏูุฏุฉ |
| `sale` | ๐ฐ | ุนูููุฉ ุจูุน |
| `review` | โญ | ุชูููู ุฌุฏูุฏ |
| `favorite` | โค๏ธ | ุฅุถุงูุฉ ููููุถูุฉ |
| `auction_start` | ๐ | ุจุฏุก ูุฒุงุฏ |
| `auction_end` | โฐ | ุงูุชูุงุก ูุฒุงุฏ |
| `auction_won` | ๐ | ุฑุจุญ ูุฒุงุฏ |
| `outbid` | ๐ข | ุชุฎุทู ูุฒุงูุฏุฉ |
| `system` | ๐ | ุฅุดุนุงุฑ ุงููุธุงู |

## ุงุณุชุฎุฏุงู ูู Navbar ู Sidebar

ุชู ุฏูุฌ ุงููุธุงู ูู:
- **Navbar**: ูุธูุฑ ููุฌููุน ูู ุฃุนูู ุงูุตูุญุฉ
- **Sidebar**: ูุธูุฑ ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ูููุญุฉ ุงูุชุญูู

## ุฃูุซูุฉ ุนูู ุงูุงุณุชุฎุฏุงู

### ูุซุงู 1: ุฅุดุนุงุฑ ุนูุฏ ูุฒุงูุฏุฉ ุฌุฏูุฏุฉ

```typescript
// ูู ููู BidForm ุฃู edge function
const handleNewBid = async (auctionId: string, bidderId: string, bidAmount: number) => {
  // ุงูุญุตูู ุนูู ูุนูููุงุช ุงููุฒุงุฏ
  const { data: auction } = await supabase
    .from("auctions")
    .select("listing_id, listings(user_id, title)")
    .eq("id", auctionId)
    .single();

  if (auction?.listings) {
    // ุฅุดุนุงุฑ ุตุงุญุจ ุงููุฒุงุฏ
    await createNotification({
      userId: auction.listings.user_id,
      title: "ูุฒุงูุฏุฉ ุฌุฏูุฏุฉ! ๐จ",
      message: `ุชู ุชูุฏูู ูุฒุงูุฏุฉ ุจูููุฉ ${bidAmount} ุฌ.ู ุนูู ุฅุนูุงู "${auction.listings.title}"`,
      type: "bid",
      listingId: auction.listing_id,
      relatedUserId: bidderId
    });
  }
};
```

### ูุซุงู 2: ุฅุดุนุงุฑ ุนูุฏ ุฅุถุงูุฉ ุชูููู

```typescript
const handleNewReview = async (sellerId: string, reviewerId: string, rating: number) => {
  await createNotification({
    userId: sellerId,
    title: "ุชูููู ุฌุฏูุฏ โญ",
    message: `ุญุตูุช ุนูู ุชูููู ${rating} ูุฌูู`,
    type: "review",
    relatedUserId: reviewerId
  });
};
```

### ูุซุงู 3: ุชูุธูู ุงูุฅุดุนุงุฑุงุช ุงููุฏููุฉ

```typescript
import { cleanupOldNotifications } from "@/lib/notifications";

// ุญุฐู ุงูุฅุดุนุงุฑุงุช ุงูููุฑูุกุฉ ุงูุฃูุฏู ูู 30 ููู
await cleanupOldNotifications(userId);
```

## ุงูุฃูุงู (RLS)

ุงููุธุงู ูุณุชุฎุฏู Row Level Security (RLS) ูู Supabase:

- ุงููุณุชุฎุฏููู ูููููู ููุท ุฑุคูุฉ ุฅุดุนุงุฑุงุชูู ุงูุฎุงุตุฉ
- ุงููุณุชุฎุฏููู ูููููู ุชุญุฏูุซ ูุญุฐู ุฅุดุนุงุฑุงุชูู ููุท
- ูุง ูููู ูููุณุชุฎุฏููู ุฅูุดุงุก ุฅุดุนุงุฑุงุช ูุจุงุดุฑุฉ (ูุฌุจ ุฃู ูุชู ุฐูู ูู ุงูู backend)

## ุงูุตูุงูุฉ ูุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ

### ุฃููุงุฑ ููุชุทููุฑ:

1. **ุฅุดุนุงุฑุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู**: ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ูููุฉ ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
2. **ุฅุดุนุงุฑุงุช Push**: ุฅุถุงูุฉ Web Push Notifications ูููุชุตูุญ
3. **ุชูุถููุงุช ุงูุฅุดุนุงุฑุงุช**: ุงูุณูุงุญ ูููุณุชุฎุฏููู ุจุงุฎุชูุงุฑ ุฃููุงุน ุงูุฅุดุนุงุฑุงุช
4. **ุชุฌููุน ุงูุฅุดุนุงุฑุงุช**: ุฏูุฌ ุงูุฅุดุนุงุฑุงุช ุงููุชุดุงุจูุฉ
5. **ุฅุญุตุงุฆูุงุช**: ุชุชุจุน ูุนุฏูุงุช ูุชุญ ูุชูุงุนู ุงูุฅุดุนุงุฑุงุช

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงูุฅุดุนุงุฑุงุช ูุง ุชุธูุฑ ูู ุงูููุช ุงููุนูู

1. ุชุฃูุฏ ูู ุฃู ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู
2. ุชุญูู ูู console ููุฃุฎุทุงุก
3. ุชุฃูุฏ ูู ุฃู ุฌุฏูู notifications ูุฏูู RLS policies ุตุญูุญุฉ

### ุงูุฅุดุนุงุฑุงุช ุงููุฏููุฉ ุชุธูุฑ

ุงุณุชุฎุฏู ุฏุงูุฉ `cleanupOldNotifications` ูุญุฐู ุงูุฅุดุนุงุฑุงุช ุงููุฏููุฉ ุจุดูู ุฏูุฑู.
